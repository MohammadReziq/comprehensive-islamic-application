# أهم 5 إصلاحات/تحسينات في التطبيق (بدون قصة تسجيل الدخول)

مرجع سريع للعودة إليها — مرتبة حسب الأولوية من الخطة الشاملة.

---

## 1. إصلاح زر النسخ في الشاشة الرئيسية

- **المشكلة:** في حوار "بيانات دخول الابن" زر النسخ له `onPressed: () {}` (فارغ).
- **الحل:** في `_credRow` استخدام `Clipboard.setData(ClipboardData(text: value))` عند الضغط، مع SnackBar "تم النسخ".
- **الملف:** `lib/app/features/parent/presentation/screens/home_screen.dart` (حوالي السطر 165).
- **السبب:** إصلاح سريع ولا يعتمد على ميزات أخرى.

---

## 2. أوقات الصلاة بالـ GPS الفعلي (ولي الأمر)

- **الوضع الحالي:** الشاشة الرئيسية تستخدم `PrayerTimesService.defaultLat/defaultLng` (ثابتة).
- **المطلوب:** الحصول على الموقع الحالي عبر `geolocator` (بعد الصلاحيات)، ثم `loadTimingsFor(lat, lng)` و `getNextPrayer(lat, lng)`. عند الفشل → fallback للإحداثيات الافتراضية.
- **الملفات:** `home_screen.dart` (initState/تحميل المواقيت)، `prayer_times_service.dart` يبقى كما هو (يستقبل lat/lng).
- **السبب:** تحسين تجربة يومية لولي الأمر.

---

## 3. تعديل الملف الشخصي (اسم، هاتف، تغيير كلمة المرور)

- **النطاق:** تعديل الاسم، الهاتف، **تغيير كلمة المرور** من داخل البروفايل. **بدون تغيير الصورة حالياً** (أول حرف من الاسم يبقى).
- **تغيير كلمة المرور:** حقل كلمة المرور الحالية + الجديدة + تأكيد؛ استدعاء `AuthRepository.updatePassword` دون تسجيل خروج (مختلف عن تدفق "نسيت كلمة المرور").
- **الملفات:** `profile_screen.dart`، إضافة حدث/معالج في auth_bloc إن لزم (تغيير كلمة المرور من البروفايل).
- **المرجع:** `tasks/profile_improvement_plan.md`.

---

## 4. ميزة الإعلانات (كاملة)

- **النطاق:** إرسال من إمام/مشرف/سوبر أدمن، استقبال عند ولي الأمر، قراءة/غير مقروء، أدوار وهدف (مسجد، مجموعة، منصة).
- **قاعدة البيانات:** توسيع `announcements`، جدول `announcement_reads`، RLS.
- **الواجهات:** قائمة إعلانات للوالد، إدارة إعلانات للإمام/المشرف، إرسال للسوبر أدمن.
- **المرجع:** `tasks/master_implementation_plan.md` — القسم 1.

---

## 5. تقارير الوالدين (رسوم بيانية أسبوعية/شهرية)

- **الهدف:** رسم بياني أسبوعي/شهري لتقدم الطفل في الصلاة مع مقارنة المسجد والبيت.
- **البيانات:** من جداول الحضور/النقاط (استعلامات تجميعية).
- **التنفيذ:** استخدام `fl_chart` (موجود)، شاشة أو قسم في واجهة ولي الأمر (اختيار الطفل + فترة + رسم).
- **المرجع:** `tasks/master_implementation_plan.md` — القسم 5.

---

## ترتيب مقترح للتنفيذ

| # | المهمة              | تعليق                    |
|---|---------------------|---------------------------|
| 1 | زر النسخ            | إصلاح سريع               |
| 2 | أوقات الصلاة GPS   | تحسين يومي               |
| 3 | البروفايل (كلمة مرور + اسم/هاتف) | مكمل للملف الشخصي |
| 4 | الإعلانات (كاملة)  | ميزة كبيرة               |
| 5 | تقارير الوالدين (رسوم) | يعتمد على بيانات الحضور |

---

**ملاحظة:** Dark/Light Mode (مفتاح في الإعدادات + shared_preferences) يبقى تحسيناً مستقلاً يمكن إضافته لاحقاً بعد هذه الخمسة.
